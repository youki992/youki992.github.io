<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½‘ç»œå®‰å…¨åœ°ç‰¢éª‘å£«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            color: #fff;
        }

        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #gameCanvas {
            border: 2px solid #00e5ff;
            background: #0f0f23;
            box-shadow: 0 0 30px rgba(0, 229, 255, 0.3);
        }

        /* UIç•Œé¢ */
        .ui-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }

        /* å°åœ°å›¾ */
        .minimap {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 180px;
            height: 180px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00e5ff;
            border-radius: 10px;
            pointer-events: auto;
        }

        .minimap-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            width: 100%;
            height: 100%;
            gap: 2px;
            padding: 5px;
        }

        .minimap-room {
            background: #333;
            border: 1px solid #555;
            border-radius: 3px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .minimap-room.current {
            background: #00e5ff;
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.8);
        }

        .minimap-room.cleared {
            background: #4caf50;
        }

        .minimap-room.unexplored {
            background: #666;
        }

        /* ç©å®¶çŠ¶æ€æ  */
        .player-stats {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00e5ff;
            border-radius: 10px;
            padding: 15px;
            min-width: 200px;
        }

        .stat-bar {
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 12px;
            color: #ccc;
            margin-bottom: 3px;
        }

        .stat-fill {
            width: 100%;
            height: 8px;
            background: #333;
            border-radius: 4px;
            overflow: hidden;
        }

        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ff6666);
            transition: width 0.3s ease;
        }

        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #4444ff, #6666ff);
            transition: width 0.3s ease;
        }

        /* æ­¦å™¨ä¿¡æ¯ */
        .weapon-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00e5ff;
            border-radius: 10px;
            padding: 15px;
            min-width: 250px;
        }

        .weapon-name {
            font-size: 16px;
            color: #00e5ff;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .weapon-stats {
            font-size: 12px;
            color: #ccc;
        }

        /* å…³å¡ä¿¡æ¯ */
        .level-info {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00e5ff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        /* å¼€å§‹ç•Œé¢ */
        .start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .game-title {
            font-size: 48px;
            color: #00e5ff;
            text-shadow: 0 0 20px rgba(0, 229, 255, 0.8);
            margin-bottom: 20px;
            font-weight: bold;
        }

        .game-subtitle {
            font-size: 18px;
            color: #ccc;
            margin-bottom: 40px;
        }

        .start-button {
            background: linear-gradient(45deg, #00e5ff, #0099cc);
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 229, 255, 0.3);
        }

        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 229, 255, 0.5);
        }

        /* å…³å¡å®Œæˆç•Œé¢ */
        .level-complete {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .complete-title {
            font-size: 36px;
            color: #4caf50;
            text-shadow: 0 0 20px rgba(76, 175, 80, 0.8);
            margin-bottom: 20px;
        }

        .complete-stats {
            color: #ccc;
            margin-bottom: 30px;
            text-align: center;
        }

        /* å¥–åŠ±é¡µé¢ */
        .reward-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .reward-title {
            font-size: 48px;
            color: #ffd700;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
            margin-bottom: 30px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
            to { text-shadow: 0 0 40px rgba(255, 215, 0, 1), 0 0 60px rgba(255, 215, 0, 0.8); }
        }

        .reward-content {
             text-align: center;
             color: #ccc;
             max-width: 600px;
             line-height: 1.6;
         }

         /* é€šç”¨ç•Œé¢æ ·å¼ */
         .screen {
             position: absolute;
             top: 0;
             left: 0;
             width: 100%;
             height: 100%;
             background: rgba(0, 0, 0, 0.95);
             display: none;
             justify-content: center;
             align-items: center;
             z-index: 100;
         }

         .screen-content {
             background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
             border: 2px solid #00e5ff;
             border-radius: 15px;
             padding: 30px;
             max-width: 800px;
             max-height: 90vh;
             overflow-y: auto;
             box-shadow: 0 0 30px rgba(0, 229, 255, 0.3);
         }

         .screen-content h1 {
             color: #00e5ff;
             text-align: center;
             margin-bottom: 30px;
             font-size: 32px;
             text-shadow: 0 0 20px rgba(0, 229, 255, 0.8);
         }

         .instructions-content {
             display: grid;
             grid-template-columns: 1fr 1fr;
             gap: 20px;
             margin-bottom: 30px;
         }

         .instruction-section {
             background: rgba(0, 0, 0, 0.3);
             padding: 20px;
             border-radius: 10px;
             border: 1px solid #333;
         }

         .instruction-section h3 {
             color: #00e5ff;
             margin-bottom: 15px;
             font-size: 18px;
         }

         .instruction-section p, .instruction-section li {
             color: #ccc;
             line-height: 1.6;
             margin-bottom: 8px;
         }

         .controls-grid {
             display: grid;
             grid-template-columns: 1fr;
             gap: 10px;
         }

         .control-item {
             display: flex;
             align-items: center;
             gap: 15px;
         }

         .key {
             background: #333;
             color: #00e5ff;
             padding: 5px 10px;
             border-radius: 5px;
             font-weight: bold;
             min-width: 60px;
             text-align: center;
         }

         .desc {
             color: #ccc;
         }

         .highlight {
             color: #ffd700;
             font-weight: bold;
         }

         .enemy-types {
             display: grid;
             grid-template-columns: 1fr;
             gap: 10px;
         }

         .enemy-type {
             display: flex;
             align-items: center;
             gap: 15px;
             padding: 10px;
             background: rgba(0, 0, 0, 0.2);
             border-radius: 8px;
         }

         .enemy-icon {
             font-size: 24px;
             width: 40px;
             text-align: center;
         }

         .enemy-type strong {
             color: #00e5ff;
             display: block;
             margin-bottom: 5px;
         }

         .enemy-type p {
             margin: 0;
             font-size: 12px;
         }

         .button-group {
             display: flex;
             justify-content: center;
             gap: 20px;
             margin-top: 20px;
         }

         .btn {
             padding: 12px 25px;
             border: none;
             border-radius: 8px;
             font-size: 16px;
             cursor: pointer;
             transition: all 0.3s ease;
             font-weight: bold;
         }

         .btn-primary {
             background: linear-gradient(45deg, #00e5ff, #0099cc);
             color: white;
             box-shadow: 0 4px 15px rgba(0, 229, 255, 0.3);
         }

         .btn-primary:hover {
             transform: translateY(-2px);
             box-shadow: 0 6px 20px rgba(0, 229, 255, 0.5);
         }

         .btn-secondary {
             background: linear-gradient(45deg, #666, #888);
             color: white;
             box-shadow: 0 4px 15px rgba(102, 102, 102, 0.3);
         }

         .btn-secondary:hover {
             transform: translateY(-2px);
             box-shadow: 0 6px 20px rgba(102, 102, 102, 0.5);
         }

         .subtitle {
             text-align: center;
             color: #ccc;
             margin-bottom: 30px;
             font-size: 18px;
         }
     </style>
</head>
<body>
    <div id="gameContainer">
        <!-- æ¸¸æˆç”»å¸ƒ -->
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <!-- UIè¦†ç›–å±‚ -->
        <div class="ui-overlay">
            <!-- å°åœ°å›¾ -->
            <div class="minimap">
                <div class="minimap-grid" id="minimapGrid">
                    <!-- 9ä¸ªæˆ¿é—´æ ¼å­å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- ç©å®¶çŠ¶æ€æ  -->
            <div class="player-stats">
                <div class="stat-bar">
                    <div class="stat-label">ç”Ÿå‘½å€¼</div>
                    <div class="stat-fill">
                        <div class="health-fill" id="healthFill" style="width: 100%;"></div>
                    </div>
                </div>
                <div class="stat-bar">
                    <div class="stat-label">èƒ½é‡</div>
                    <div class="stat-fill">
                        <div class="energy-fill" id="energyFill" style="width: 100%;"></div>
                    </div>
                </div>
            </div>
            
            <!-- æ­¦å™¨ä¿¡æ¯ -->
            <div class="weapon-info">
                <div class="weapon-name" id="weaponName">æ¿€å…‰å‰‘</div>
                <div class="weapon-stats" id="weaponStats">
                    ä¼¤å®³: 25-35 | å°„ç¨‹: 150px | æ”»é€Ÿ: 1.2/s
                </div>
            </div>
            
            <!-- å…³å¡ä¿¡æ¯ -->
            <div class="level-info">
                <div style="font-size: 14px; color: #ccc;">å…³å¡</div>
                <div style="font-size: 24px; color: #00e5ff;" id="currentLevel">1</div>
                <div style="font-size: 12px; color: #ccc;" id="roomInfo">æˆ¿é—´ 1/9</div>
            </div>
        </div>
        
        <!-- å¼€å§‹ç•Œé¢ -->
        <div class="start-screen" id="startScreen">
            <div class="game-title">ç½‘ç»œå®‰å…¨åœ°ç‰¢éª‘å£«</div>
            <div class="game-subtitle">æ¢ç´¢åœ°ç‰¢ï¼Œæ¶ˆç­ç½‘ç»œå¨èƒï¼Œä¿å«æ•°å­—ä¸–ç•Œï¼</div>
            <button class="start-button" onclick="startGame()">å¼€å§‹å†’é™©</button>
            <button class="start-button" onclick="showInstructions()" style="margin-top: 15px; background: #4a90e2;">æ¸¸æˆè¯´æ˜</button>
        </div>
        
        <!-- å…³å¡å®Œæˆç•Œé¢ -->
        <div class="level-complete" id="levelComplete">
            <div class="complete-title">å…³å¡å®Œæˆï¼</div>
            <div class="complete-stats" id="completeStats">
                æ¶ˆç­æ€ªç‰©: 27<br>
                ç”¨æ—¶: 3åˆ†42ç§’<br>
                è·å¾—ç»éªŒ: 150
            </div>
            <button class="start-button" onclick="nextLevel()">è¿›å…¥ä¸‹ä¸€å…³</button>
            <button class="start-button" onclick="backToMenu()" style="margin-top: 10px; background: #666;">è¿”å›ä¸»èœå•</button>
        </div>
        
        <!-- å¥–åŠ±é¡µé¢ -->
        <div class="reward-screen" id="rewardScreen">
            <div class="reward-title">ğŸ‰ æ­å–œé€šå…³ï¼ ğŸ‰</div>
            <div class="reward-content">
                <h2 style="color: #00e5ff; margin-bottom: 20px;">ç½‘ç»œå®‰å…¨å«å£«</h2>
                <p>ä½ æˆåŠŸæ¸…é™¤äº†æ‰€æœ‰ç½‘ç»œå¨èƒï¼Œä¿å«äº†æ•°å­—ä¸–ç•Œçš„å®‰å…¨ï¼</p>
                <p>åœ¨è¿™æ¬¡å†’é™©ä¸­ï¼Œä½ å±•ç°äº†å‡ºè‰²çš„æˆ˜æ–—æŠ€å·§å’Œç­–ç•¥æ€ç»´ã€‚</p>
                <br>
                <p style="color: #ffd700;">ğŸ† è·å¾—æˆå°±ï¼šåœ°ç‰¢å¾æœè€…</p>
                <p style="color: #4caf50;">ğŸ’ è·å¾—å¥–åŠ±ï¼šç½‘ç»œå®‰å…¨ä¸“å®¶è¯ä¹¦</p>
                <br>
                <button class="start-button" onclick="restartGame()" style="margin-top: 20px;">é‡æ–°å¼€å§‹</button>
            </div>
        </div>
    </div>

    <!-- æ¸¸æˆè¯´æ˜ç•Œé¢ -->
    <div id="instructionsScreen" class="screen">
        <div class="screen-content">
            <h1>ğŸ® æ¸¸æˆè¯´æ˜</h1>
            <div class="instructions-content">
                <div class="instruction-section">
                    <h3>ğŸ¯ æ¸¸æˆç›®æ ‡</h3>
                    <p>æ¸…é™¤æ‰€æœ‰9ä¸ªæˆ¿é—´ä¸­çš„ç½‘ç»œå¨èƒï¼Œå®Œæˆ3ä¸ªå…³å¡çš„æŒ‘æˆ˜ï¼</p>
                </div>
                
                <div class="instruction-section">
                    <h3>ğŸ•¹ï¸ æ“ä½œæ§åˆ¶</h3>
                    <div class="controls-grid">
                        <div class="control-item">
                            <span class="key">WASD</span>
                            <span class="desc">ç§»åŠ¨è§’è‰²</span>
                        </div>
                        <div class="control-item">
                            <span class="key">é¼ æ ‡</span>
                            <span class="desc">ç„å‡†å’Œæ”»å‡»</span>
                        </div>
                        <div class="control-item">
                            <span class="key">ç©ºæ ¼</span>
                            <span class="desc">å†²åˆºï¼ˆæ¶ˆè€—èƒ½é‡ï¼‰</span>
                        </div>
                    </div>
                </div>
                
                <div class="instruction-section">
                    <h3>âš¡ èƒ½é‡ç³»ç»Ÿ</h3>
                    <ul>
                        <li>æ”»å‡»æ¶ˆè€— <span class="highlight">20ç‚¹èƒ½é‡</span></li>
                        <li>å†²åˆºæ¶ˆè€— <span class="highlight">20ç‚¹èƒ½é‡</span></li>
                        <li>èƒ½é‡ä¼šè‡ªåŠ¨ç¼“æ…¢æ¢å¤</li>
                        <li>åˆç†ç®¡ç†èƒ½é‡æ˜¯è·èƒœå…³é”®</li>
                    </ul>
                </div>
                
                <div class="instruction-section">
                    <h3>ğŸ¦  æ•Œäººç±»å‹</h3>
                    <div class="enemy-types">
                        <div class="enemy-type">
                            <span class="enemy-icon virus">ğŸ¦ </span>
                            <div>
                                <strong>ç—…æ¯’</strong>
                                <p>å¸¦åˆºåœ†å½¢ï¼Œä¼šä¸»åŠ¨æ”»å‡»</p>
                            </div>
                        </div>
                        <div class="enemy-type">
                            <span class="enemy-icon trojan">ğŸ´</span>
                            <div>
                                <strong>æœ¨é©¬</strong>
                                <p>æ–¹å½¢ä¼ªè£…ï¼Œéšè—æ¶æ„ä»£ç </p>
                            </div>
                        </div>
                        <div class="enemy-type">
                            <span class="enemy-icon worm">ğŸ›</span>
                            <div>
                                <strong>è •è™«</strong>
                                <p>æ¤­åœ†å½¢ï¼Œå¿«é€Ÿç§»åŠ¨</p>
                            </div>
                        </div>
                        <div class="enemy-type">
                            <span class="enemy-icon spyware">ğŸ‘ï¸</span>
                            <div>
                                <strong>é—´è°è½¯ä»¶</strong>
                                <p>è±å½¢ç›‘è§†ï¼Œæ‰«ææ”»å‡»</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="instruction-section">
                    <h3>ğŸ—ºï¸ åœ°å›¾ç³»ç»Ÿ</h3>
                    <ul>
                        <li>æ¯å…³æœ‰9ä¸ªæˆ¿é—´éœ€è¦æ¸…ç†</li>
                        <li>ä»ä¸­å¿ƒæˆ¿é—´å¼€å§‹æ¢ç´¢</li>
                        <li>å°åœ°å›¾æ˜¾ç¤ºæˆ¿é—´çŠ¶æ€</li>
                        <li>æ³¨æ„å¢™å£éšœç¢ç‰©çš„é˜»æŒ¡</li>
                    </ul>
                </div>
                
                <div class="instruction-section">
                    <h3>ğŸ”« æ­¦å™¨ç³»ç»Ÿ</h3>
                    <ul>
                        <li>æ¯å…³å¼€å§‹è·å¾—éšæœºæ­¦å™¨</li>
                        <li>è¿‘æˆ˜æ­¦å™¨ï¼šæ¿€å…‰å‰‘ã€é‡å­åˆ€</li>
                        <li>è¿œç¨‹æ­¦å™¨ï¼šç­‰ç¦»å­æªã€ç”µç£ç‚®ã€ç—…æ¯’æª</li>
                        <li>ä¸åŒæ­¦å™¨æœ‰ä¸åŒä¼¤å®³å’Œå°„ç¨‹</li>
                    </ul>
                </div>
            </div>
            
            <div class="button-group">
                <button onclick="backToMenu()" class="btn btn-secondary">è¿”å›ä¸»èœå•</button>
                <button onclick="startGameFromInstructions()" class="btn btn-primary">å¼€å§‹æ¸¸æˆ</button>
            </div>
        </div>
    </div>

    <div id="startScreen" class="screen">
        <div class="screen-content">
            <h1>ğŸ›¡ï¸ ç½‘ç»œå®‰å…¨åœ°ç‰¢éª‘å£«</h1>
            <p class="subtitle">æ¸…é™¤ç½‘ç»œå¨èƒï¼Œä¿æŠ¤æ•°å­—ä¸–ç•Œï¼</p>
            <div class="button-group">
                <button onclick="startGame()" class="btn btn-primary">å¼€å§‹æ¸¸æˆ</button>
                <button onclick="showInstructions()" class="btn btn-secondary">æ¸¸æˆè¯´æ˜</button>
            </div>
        </div>
    </div>

    <div class="level-complete" id="levelComplete">
        <div class="complete-title">å…³å¡å®Œæˆï¼</div>
        <div class="complete-stats" id="completeStats">
            æ¶ˆç­æ€ªç‰©: 27<br>
            ç”¨æ—¶: 3åˆ†42ç§’<br>
            è·å¾—ç»éªŒ: 150
        </div>
        <button class="start-button" onclick="nextLevel()">è¿›å…¥ä¸‹ä¸€å…³</button>
        <button class="start-button" onclick="backToMenu()" style="margin-top: 10px; background: #666;">è¿”å›ä¸»èœå•</button>
    </div>
    <div class="reward-screen" id="rewardScreen">
        <div class="reward-title">ğŸ‰ æ­å–œé€šå…³ï¼ ğŸ‰</div>
        <div class="reward-content">
            <h2 style="color: #00e5ff; margin-bottom: 20px;">ç½‘ç»œå®‰å…¨å«å£«</h2>
            <p>ä½ æˆåŠŸæ¸…é™¤äº†æ‰€æœ‰ç½‘ç»œå¨èƒï¼Œä¿å«äº†æ•°å­—ä¸–ç•Œçš„å®‰å…¨ï¼</p>
            <p>åœ¨è¿™æ¬¡å†’é™©ä¸­ï¼Œä½ å±•ç°äº†å‡ºè‰²çš„æˆ˜æ–—æŠ€å·§å’Œç­–ç•¥æ€ç»´ã€‚</p>
            <br>
            <p style="color: #ffd700;">ğŸ† è·å¾—æˆå°±ï¼šåœ°ç‰¢å¾æœè€…</p>
            <p style="color: #4caf50;">ğŸ’ è·å¾—å¥–åŠ±ï¼šç½‘ç»œå®‰å…¨ä¸“å®¶è¯ä¹¦</p>
            <br>
            <button class="start-button" onclick="restartGame()" style="margin-top: 20px;">é‡æ–°å¼€å§‹</button>
        </div>
    </div>

    <script src="dungeon-knight.js"></script>
</body>
</html>